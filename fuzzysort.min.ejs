const fuzzysort=(()=>{"use strict";var f=r=>{"number"==typeof r?r=""+r:"string"!=typeof r&&(r="");var e=v(r);return H(r,{t:e.i,o:e.v,u:e.l})};class t{get["indexes"](){return this.p.slice(0,this.p.h).sort((r,e)=>r-e)}set["indexes"](r){return this.p=r}["highlight"](r,e){for(var[r,f="<b>",t="</b>"]=[this,r,e],i="function"==typeof f?f:void 0,a=r.target,o=a.length,n=r.indexes,v="",s=0,u=0,l=!1,c=[],b=0;b<o;++b){var p=a[b];if(n[u]===b){if(++u,l||(l=!0,i?(c.push(v),v=""):v+=f),u===n.length){i?(c.push(i(v+=p,s++)),v="",c.push(a.substr(b+1))):v+=p+t+a.substr(b+1);break}}else l&&(l=!1,i?(c.push(i(v,s++)),v=""):v+=t);v+=p}return i?c:v}get["score"](){return e(this.g)}set["score"](r){this.g=I(r)}}class G extends Array{get["score"](){return e(this.g)}set["score"](r){this.g=I(r)}}var o,n,r,i,H=(r,e)=>{var f=new t;return f.target=r,f.obj=e.obj??Y,f.g=e.g??W,f.p=e.p??[],f.t=e.t??"",f.o=e.o??Y,f._=e._??Y,f.u=e.u??0,f},e=r=>r===W?0:1<r?r:Math.E**(-2*((1-r)**.04307-1)),I=r=>0===r?W:1<r?r:1-Math.pow(Math.log(r)/-2+1,1/.04307),a=r=>{"number"==typeof r?r=""+r:"string"!=typeof r&&(r=""),r=r.trim();var e=v(r),f=[];if(e.k)for(var t,i=r.split(/\s+/),i=[...new Set(i)],a=0;a<i.length;a++)""!==i[a]&&(t=v(i[a]),f.push({v:t.v,i:i[a].toLowerCase(),k:!1}));return{v:e.v,i:e.i,k:e.k,l:e.l,S:f}},J=r=>{var e;return 999<r.length?f(r):(void 0===(e=s.get(r))&&(e=f(r),s.set(r,e)),e)},K=r=>{var e;return 999<r.length?a(r):(void 0===(e=u.get(r))&&(e=a(r),u.set(r,e)),e)},N=(r,e,f=!1,t=!1)=>{if(!1===f&&r.k)return M(r,e,t);for(var f=r.i,i=r.v,a=i[0],o=e.o,n=i.length,v=o.length,s=0,u=0,l=0;;){if(a===o[u]){if(C[l++]=u,++s===n)break;a=i[s]}if(v<=++u)return Y}var s=0,c=!1,b=0,p=e._,w=(p===Y&&(p=e._=z(e.target)),0);if((u=0===C[0]?0:p[C[0]-1])!==v)for(;;)if(v<=u){if(s<=0)break;if(200<++w)break;--s;var h=m[--b],u=p[h]}else if(i[s]===o[u]){if(m[b++]=u,++s===n){c=!0;break}++u}else u=p[u];var d=n<=1?-1:e.t.indexOf(f,C[0]),g=!!~d,y=g&&(0===d||e._[d-1]===d);if(g&&!y)for(var _=0;_<p.length;_=p[_])if(!(_<=d)){for(var k=0;k<n&&i[k]===e.o[_+k];k++);if(k===n){d=_,y=!0;break}}t=r=>{for(var e=0,f=0,t=1;t<n;++t)r[t]-r[t-1]!=1&&(e-=r[t],++f);if(e-=(12+(r[n-1]-r[0]-(n-1)))*f,0!==r[0]&&(e-=r[0]*r[0]*.2),c){for(var i=1,t=p[0];t<v;t=p[t])++i;24<i&&(e*=10*(i-24))}else e*=1e3;return e-=(v-n)/2,g&&(e/=1+n*n*1),y&&(e/=1+n*n*1),e-=(v-n)/2};if(c)if(y){for(_=0;_<n;++_)C[_]=d+_;S=C,x=t(C)}else S=m,x=t(m);else{if(g)for(var _=0;_<n;++_)C[_]=d+_;var S,x=t(S=C)}e.g=x;for(_=0;_<n;++_)e.p[_]=S[_];return e.p.h=n,H(e.target,{g:e.g,p:e.p})},M=(r,e,f)=>{for(var t=new Set,i=0,a=Y,o=0,n=r.S,v=n.length,s=0,u=()=>{for(let r=s-1;0<=r;r--)e._[k[2*r+0]]=k[2*r+1]},l=!1,c=0;c<v;++c){P[c]=W;var b=n[c],a=N(b,e);if(f){if(a===Y)continue;l=!0}else if(a===Y)return u(),Y;if(!(c===v-1)){var p=a.p,w=!0;for(let r=0;r<p.h-1;r++)if(p[r+1]-p[r]!=1){w=!1;break}if(w){var h=p[p.h-1]+1,d=e._[h-1];for(let r=h-1;0<=r&&d===e._[r];r--)e._[r]=h,k[2*s+0]=r,k[2*s+1]=d,s++}}i+=a.g/v,P[c]=a.g/v,a.p[0]<o&&(i-=2*(o-a.p[0]));for(var o=a.p[0],g=0;g<a.p.h;++g)t.add(a.p[g])}if(f&&!l)return Y;u();var y=N(r,e,!0);if(y!==Y&&y.g>i){if(f)for(c=0;c<v;++c)P[c]=y.g/v;return y}(a=f?e:a).g=i;var _,c=0;for(_ of t)a.p[c++]=_;return a.p.h=c,a},v=r=>{for(var e=r.length,f=r.toLowerCase(),t=[],i=0,a=!1,o=0;o<e;++o){var n=t[o]=f.charCodeAt(o);32===n?a=!0:i|=1<<(97<=n&&n<=122?n-97:48<=n&&n<=57?26:n<=127?30:31)}return{v:t,l:i,k:a,i:f}},z=r=>{for(var e=r.length,f=(r=>{for(var e=r.length,f=[],t=0,i=!1,a=!1,o=0;o<e;++o){var n=r.charCodeAt(o),v=65<=n&&n<=90,n=v||97<=n&&n<=122||48<=n&&n<=57,s=v&&!i||!a||!n,i=v,a=n;s&&(f[t++]=o)}return f})(r),t=[],i=f[0],a=0,o=0;o<e;++o)o<i?t[o]=i:(i=f[++a],t[o]=void 0===i?e:i);return t},s=new Map,u=new Map,C=[],m=[],k=[],O=[],P=[],Q=[],R=[],T=(r,e)=>{var f=r[e];if(void 0!==f)return f;if("function"==typeof e)return e(r);for(var t=e,i=(t=Array.isArray(e)?t:e.split(".")).length,a=-1;r&&++a<i;)r=r[t[a]];return r},U=r=>"object"==typeof r&&"number"==typeof r.u,V=1/0,W=-V,X=[],Y=(X.total=0,null),Z=f(""),$=(o=[],n=0,i=r=>{for(var e=o[i=0],f=1;f<n;){var t=f+1,i=f;t<n&&o[t].g<o[f].g&&(i=t),o[i-1>>1]=o[i],f=1+(i<<1)}for(var a=i-1>>1;0<i&&e.g<o[a].g;a=(i=a)-1>>1)o[i]=o[a];o[i]=e},(r={}).add=r=>{var e=n;o[n++]=r;for(var f=e-1>>1;0<e&&r.g<o[f].g;f=(e=f)-1>>1)o[e]=o[f];o[e]=r},r.M=r=>{var e;if(0!==n)return e=o[0],o[0]=o[--n],i(),e},r.C=r=>{if(0!==n)return o[0]},r.m=r=>{o[0]=r,i()},r);return{single:(r,e)=>{var f;return!r||!e||(r=K(r),U(e)||(e=J(e)),((f=r.l)&e.u)!==f)?Y:N(r,e)},go:(r,e,f)=>{if(!r)if(f?.all){var t=e;var i=f;var a=[],o=(a.total=t.length,i?.limit||V);if(i?.key)for(var n=0;n<t.length;n++){var v=t[n];var s=T(v,i.key);if(s==Y)continue;if(!U(s))s=J(s);var u=H(s.target,{g:s.g,obj:s.obj});a.push(u);if(a.length>=o)return a}else if(i?.keys)for(n=0;n<t.length;n++){v=t[n];var l=new G(i.keys.length);for(var c=i.keys.length-1;c>=0;--c){s=T(v,i.keys[c]);if(!s){l[c]=Z;continue}if(!U(s))s=J(s);s.g=W;s.p.h=0;l[c]=s}l.obj=v;l.g=W;a.push(l);if(a.length>=o)return a}else for(n=0;n<t.length;n++){s=t[n];if(s==Y)continue;if(!U(s))s=J(s);s.g=W;s.p.h=0;a.push(s);if(a.length>=o)return a}return a;return}else return X;var b=K(r),p=b.l,w=b.k,h=I(f?.threshold||0),d=f?.limit||V,g=0,y=0,_=e.length;function k(r){g<d?($.add(r),++g):(++y,r.g>$.C().g&&$.m(r))}if(f?.key)for(var S=f.key,x=0;x<_;++x){var M=e[x];!(D=T(M,S))||(p&(D=U(D)?D:J(D)).u)!==p||(E=N(b,D))===Y||E.g<h||(E.obj=M,k(E))}else if(f?.keys){var z=f.keys,C=z.length;r:for(x=0;x<_;++x){for(var M=e[x],m=0,A=0;A<C;++A){S=z[A];(D=T(M,S))?(U(D)||(D=J(D)),m|=(Q[A]=D).u):Q[A]=Z}if((p&m)===p){if(w)for(let r=0;r<b.S.length;r++)O[r]=W;for(A=0;A<C;++A)if((D=Q[A])===Z)R[A]=Z;else if(R[A]=N(b,D,!1,w),R[A]===Y)R[A]=Z;else if(w)for(let r=0;r<b.S.length;r++)-1e3<P[r]&&O[r]>W&&(B=(O[r]+P[r])/4)>O[r]&&(O[r]=B),P[r]>O[r]&&(O[r]=P[r]);if(w){for(let r=0;r<b.S.length;r++)if(O[r]===W)continue r}else{var j=!1;for(let r=0;r<C;r++)if(R[r].g!==W){j=!0;break}if(!j)continue}var L=new G(C);for(let r=0;r<C;r++)L[r]=R[r];if(w){var q=0;for(let r=0;r<b.S.length;r++)q+=O[r]}else{var B,q=W;for(let r=0;r<C;r++)-1e3<(E=L[r]).g&&W<q&&q<(B=(q+E.g)/4)&&(q=B),E.g>q&&(q=E.g)}if(L.obj=M,L.g=q,f?.scoreFn){if(!(q=f.scoreFn(L)))continue;q=I(q),L.g=q}q<h||k(L)}}}else for(var D,E,x=0;x<_;++x)!(D=e[x])||(p&(D=U(D)?D:J(D)).u)!==p||(E=N(b,D))===Y||E.g<h||k(E);if(0===g)return X;for(var F=new Array(g),x=g-1;0<=x;--x)F[x]=$.M();return F.total=g+y,F},prepare:f,cleanup:()=>{s.clear(),u.clear()}}})();export default fuzzysort;